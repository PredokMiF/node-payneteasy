"use strict";

var _ = require('lodash-node');

var cmn = require('./src/cmnData');

// Типы событий
require('./src/callMe/byTime');
require('./src/callMe/poll');

module.exports = _.defaults({
    init: require('./src/init'),
    on: require('./src/on')
}, cmn.callMe);

// DEBUG

//var callMe = module.exports;
//var when = require('when');
//
//var SEC = 1000;
//callMe.init('postgres://postgres:1@localhost:5432/nrj')
//    .catch(function(err) {
//        console.log('init err!');console.log(err);
//    })
//    .then(function() {
//        callMe.byTime('myEvName', '61904f52-0c5a-4b96-bc23-7b4451351ae4', new Date(Date.now() + 15 * SEC), {});
//        console.log('myEvName cerate!');
//    })
//    .then(function() {
//        callMe.poll('myEvName2', '61904f52-0c5a-4b96-bc23-7b4451351ae4', [1,2,5,20,60, 30, 600], {});
//        console.log('myEvName2 cerate!');
//    });
//
//callMe.on('myEvName', function (data) {
//    console.log('myEvName');
//    console.log(data);
//});
//
//callMe.on('myEvName2', function (data) {
//    console.log('myEvName2');
//    console.log(data);
//    return when.reject('1');
//});
