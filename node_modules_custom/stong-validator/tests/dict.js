"use strict";

/* Описание работы со словарями. Когда передается строка, равная одгому из заранее заданных значений.
 * В валидатор сразу можно передавать элементарные типы, в частности числа:
 */

var v = require('../app');

module.exports = {
    // Проверяем что валидация словарю работает
    'test-dict-e9c19b57-9a5a-44c6-8d54-b70b86b71d9a': function (test) {
        var tpl = v('dict v a,b,c');
        tpl('b').
            then(function (result) {
                test.equals(result, 'b');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-ff984c51-96a4-4fed-bb4c-c18c2b572f29': function (test) {
        var tpl = v('dictionary v a,b,c');
        tpl('b').
            then(function (result) {
                test.equals(result, 'b');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-91979eb2-3d57-40bc-b53e-2e3bc9872c09': function (test) {
        var tpl = v('dict v aba,b,c');
        tpl('b').
            then(function (result) {
                test.equals(result, 'b');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-2910810f-9d18-4bd6-98c7-041c4e377796': function (test) {
        var tpl = v('dict v z');
        tpl('z').
            then(function (result) {
                test.equals(result, 'z');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-63e87cf7-61ae-4f53-aba7-fc4e2df070e9': function (test) {
        var tpl = v('dict v 1,2,3');
        tpl('2').
            then(function (result) {
                test.equals(result, '2');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-1b5ba7b2-ca6e-4d46-a7e3-4840f1e331e9': function (test) {
        var tpl = v(['dict v 1,2,3', function (obj, tpl, cfg) { return obj === '2'; }]);
        tpl('2').
            then(function (result) {
                test.equals(result, '2');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    // Ломаем
    'test-dict-2ec9ff40-db13-4a9b-a0fd-1233d07a6e15': function (test) {
        var tpl = v('dict');
        tpl().
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-d2f600f5-0de6-4bdb-a5bf-156c156b8deb': function (test) {
        var tpl = v('dict v');
        tpl('1').
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-c8eae76a-c523-46a1-9d57-449561a7939c': function (test) {
        var tpl = v('dict v a,b,c');
        tpl().
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-13392591-5824-4597-99b7-a9f8b8d277c8': function (test) {
        var tpl = v('dict v a,b,c');
        tpl(null).
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-71dc560d-d372-42b2-a1a9-f819a2213463': function (test) {
        var tpl = v('dict v a,b,c');
        tpl(undefined).
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-04ed6dd2-6158-4e62-90f5-0629d3de3605': function (test) {
        var tpl = v('dict v a,b,c');
        tpl('').
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-53199279-422f-4b2d-bc1b-3dfc7ac83f21': function (test) {
        var tpl = v('dict v a,b, c');
        tpl('a').
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-46404701-c25b-4f01-909a-f48a2354e0f1': function (test) {
        var tpl = v(['dict v 1,2,3', function(obj, tpl, cfg){return !(obj === '1');}]);
        tpl('1').
            then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    },
    'test-dict-559b8cff-f0e7-44e1-b795-719015154dd6': function (test) {
        var tpl = v(['dict v 1,2,3', function (obj, tpl, cfg) { return obj === '2'; }]);
        tpl(2).
            then(function (result) {
                test.equals(result, '2');
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-7c442355-d55e-46e8-9115-f7db423204a8': function (test) {
        var tpl = v('dict null v a,b,c');
        tpl(null)
            .then(function (result) {
                test.deepEqual(result, null);
            }, function (err) {
                test.ok(false, 'Ошибки быть не должно: ' + err);
            }).done(function () { test.done(); });
    },
    'test-dict-e869ad23-3ce1-410d-879d-a3b1dd44df22': function (test) {
        var tpl = v('dict v a,b,c');
        tpl(null)
            .then(function (result) {
                test.ok(false, 'Должна быть ошибка');
            }, function (err) {
                test.ok(err);
            }).done(function () { test.done(); });
    }
};
